<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Happy learning every day</title>
    <link rel="stylesheet" href="plugins/codemirror/lib/codemirror.css">
    <link rel="stylesheet" href="plugins/codemirror/theme/vscode-dark.css" />
    <!--支持代码折叠-->
    <link rel="stylesheet" href="plugins/codemirror/addon/fold/foldgutter.css" />
    <style>
        body {
            margin: 0;
            overflow: hidden;
        }

        .i-code,
        .i-preview {
            width: 50%;
            height: 100%;
            position: absolute;
            z-index: 1;
        }

        .i-preview {
            left: 50%;
        }

        iframe {
            width: 100%;
            height: 100%;
            border: none;
        }

        .i-menu {
            position: absolute;
            top: 0;
            bottom: 0;
            width: 309px;
            /* height: 309px; */
            left: -300px;
            z-index: 3;
            overflow: hidden;
            transition: left .5s, opacity .5s, background-color .5s;
            opacity: 0;
            text-align: center;
        }

        .i-menu:hover {
            left: 0;
            opacity: 1;
            background: linear-gradient(45deg, #6cf, #f66);
            /* background-color: #1e1e1e; */
        }

        h5 {
            color: #fff;
            text-indent: 10px;
        }

        div.ui-button,
        .ui-button {
            border: 1px solid #f66;
            padding: 0.6rem 0.9rem;
            background: #efefef;
            border-radius: 5px;
            cursor: pointer;
            margin: 10px;
        }

        .ui-button.active {
            background: linear-gradient(45deg, #f66, #6cf);
        }
    </style>
</head>

<body>
    <div class="i-menu" id="j-menu">
        <h5>Wisdom in the mind is better than money in the hand.</h5>
        <div>
            <div class="ui-button active">css</div>
            <div class="ui-button">dom</div>
            <div class="ui-button">js</div>
        </div>
        <div id="questions">
        </div>
    </div>
    <div class="i-code">
        <textarea class="form-control" id="code" name="code"></textarea>
    </div>
    <div class="i-preview">
        <iframe id="j-frame" src="pages/css/css1.html"></iframe>
    </div>
    <script src="plugins/codemirror/lib/codemirror.js"></script>
    <!--javascript代码高亮-->
    <script src="plugins/codemirror/mode/xml/xml.js"></script>
    <script src="plugins/codemirror/mode/javascript/javascript.js"></script>
    <script src="plugins/codemirror/mode/css/css.js"></script>
    <script src="plugins/codemirror/mode/htmlmixed/htmlmixed.js"></script>
    <script src="plugins/codemirror/mode/htmlembedded/htmlembedded.js"></script>
    <!--支持代码折叠-->
    <script src="plugins/codemirror/addon/mode/multiplex.js"></script>
    <script src="plugins/codemirror/addon/fold/foldcode.js"></script>
    <script src="plugins/codemirror/addon/fold/foldgutter.js"></script>
    <script src="plugins/codemirror/addon/fold/brace-fold.js"></script>
    <script src="plugins/codemirror/addon/fold/comment-fold.js"></script>
    <script>
        var editor = CodeMirror.fromTextArea(document.getElementById('code'), {
            //实现javascript代码高亮
            mode: 'application/x-ejs',
            //显示行号
            lineNumbers: true,
            //设置主题
            theme: 'vscode-dark',
            //代码折叠
            lineWrapping: true,
            foldGutter: true,
            gutters: ['CodeMirror-linenumbers', 'CodeMirror-foldgutter'],
            //括号匹配
            matchBrackets: true,
            //只读
            readOnly: true
        });
        editor.setSize('100%', '100%');

        function loadXMLDoc(url) {
            var xmlhttp;
            if (window.XMLHttpRequest) {
                //  IE7+, Firefox, Chrome, Opera, Safari 浏览器执行代码
                xmlhttp = new XMLHttpRequest();
            } else {
                // IE6, IE5 浏览器执行代码
                xmlhttp = new ActiveXObject('Microsoft.XMLHTTP');
            }
            xmlhttp.onreadystatechange = function () {
                if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                    // console.log(xmlhttp.responseText)
                    editor.setValue(xmlhttp.responseText);
                    return xmlhttp.responseText
                }
            }
            xmlhttp.open('GET', url, true);
            xmlhttp.send();
        }
        // 第一次初始化
        loadXMLDoc('pages/css/css1.html');

        let [css, dom, js] = [10, 8, 9];
        let activeBtn = null;
        let frame = document.getElementById('j-frame');
        // 默认遍历css
        let fragment = document.createDocumentFragment();
        for (let i = 1; i < css + 1; i++) {
            let button = document.createElement('button')
            button.type = 'button'
            button.className = 'ui-button'
            button.innerText = 'css' + i;
            if (i == 1) {
                activeBtn = button;
                button.classList.add('active');
            }
            fragment.appendChild(button);
        }
        questions.appendChild(fragment)

        document.addEventListener('click', function (event, index) {
            let element = event.target;
            console.log(event);
            if (element.className.includes('ui-button') && element.nodeName == 'BUTTON') {
                activeBtn.className = 'ui-button';
                element.classList.add('active');
                activeBtn = element;
                loadXMLDoc('pages/css/' + element.innerText + '.html');
                frame.src = 'pages/css/' + element.innerText + '.html';
            } else if (element.nodeName == 'DIV' && element.className.includes('ui-button')) {

            }
        });

        // 还要记录上次选中的状态
    </script>
</body>

</html>